# 通用安全审计语义提示 (Universal Semantic Hints)

> 适用于所有语言的**架构级/逻辑级**审计维度。语言级漏洞由各语言 checklist 覆盖。
> 本文件为轻量补充，仅覆盖语言无关的共性问题。

## D2: 认证 (通用)
- 密码重置令牌是否足够随机、有过期、单次使用、绑定用户？
- 多因素认证是否可被跳过（直接调用验证后接口）？
- 登录是否有暴力破解防护（速率限制/账户锁定）？

## D3: 授权 (通用)
- **IDOR**: 所有 `findById(id)` 是否同时校验 `userId`？对比 CRUD 各操作的权限一致性。
- **垂直越权**: 管理员功能是否仅靠前端隐藏？是否有服务端角色校验？
- **组织隔离**: 多租户场景下，API 是否校验资源的租户归属？

## D7: 加密 (通用)
- 弱算法: MD5/SHA1/DES/RC4/ECB 是否用于安全场景？
- 硬编码密钥/IV 是否存在于源码或配置文件中？

## D8: 信息泄露 (通用)
- 异常响应是否包含堆栈、SQL 语句、内部路径？
- 日志是否记录 password/token/secret/信用卡号？
- `.env` / `.git` / `swagger-ui` / debug 端点是否对外暴露？

## D9: 业务逻辑 (通用)
- 金额/数量/折扣是否由客户端传入且服务端未重新计算？
- 并发请求是否可导致余额/库存多次扣减（竞态条件）？
- 多步流程是否可跳过中间步骤？
- 速率限制: 验证码/短信/邮件发送是否有频率控制？
- IDOR/水平越权: 按 ID 查询资源后是否校验归属当前用户？（覆盖全部 CRUD 端点，不止 read）
- 权限注解完整性: 同一资源的 CRUD 操作权限检查是否一致？（read 有但 delete 无 = 垂直越权）
- Mass Assignment: 请求体是否直接绑定含敏感字段（role/isAdmin/tenantId）的实体？
- 数据导出/批量操作: 导出范围是否受限于当前用户/租户？能否越权批量操作？
