# WooYun 实战漏洞案例库

> 基于 WooYun 88,636 个真实漏洞案例提炼的实战方法论
> 数据来源: 2010-2016 年中国互联网真实漏洞报告

---

## 核心价值

```
┌─────────────────────────────────────────────────────────────────┐
│  与 code-audit 原有能力的互补                                    │
├─────────────────────────────────────────────────────────────────┤
│  code-audit 原有: 代码级静态分析、污点追踪、55+ 漏洞模式          │
│  WooYun 补充:     真实案例统计、绕过技巧库、逻辑漏洞模式         │
│  整合效果:        代码审计 + 渗透测试视角的完整覆盖              │
└─────────────────────────────────────────────────────────────────┘
```

---

## 漏洞类型索引

| 漏洞类型 | 案例数 | 文件 | 核心价值 |
|----------|--------|------|----------|
| **SQL注入** | 27,732 | `sql-injection.md` | 高危参数名频率统计、数据库指纹、绕过技巧 |
| **XSS跨站** | 7,532 | `xss.md` | 输出点分类矩阵、上下文绕过、DOM XSS |
| **命令执行** | 6,826 | `command-execution.md` | 入口点分类、拼接符、编码绕过 |
| **逻辑漏洞** | 8,292 | `logic-flaws.md` | 密码重置4模式、越权矩阵、验证码绕过 |
| **文件上传** | 2,711 | `file-upload.md` | 检测绕过、解析漏洞、高危CMS |
| **未授权访问** | 14,377 | `unauthorized-access.md` | 后台/API/服务未授权、IDOR |
| **信息泄露** | 7,337 | `info-disclosure.md` | 泄露类型、敏感路径、利用链 |
| **文件遍历** | 2,854 | `file-traversal.md` | 参数名、Payload编码、敏感文件 |

---

## 元思考方法论

### 漏洞本质公式

```
漏洞 = 预期行为 - 实际行为
    = 开发者假设 ⊕ 攻击者输入 → 意外状态

核心问题链:
1. 数据从哪来? (输入源) → GET/POST/Cookie/Header/文件
2. 数据到哪去? (数据流) → 验证→处理→存储→输出
3. 在哪被信任? (信任边界) → 前端/后端/数据库/系统
4. 如何被处理? (处理逻辑) → 过滤/转义/验证/执行
5. 处理后去哪? (输出点) → HTML/SQL/命令/文件
```

### 攻击面映射模型

```
          ┌─────────────────────────────────────────┐
          │            应用攻击面                    │
          └─────────────────────────────────────────┘
                            │
    ┌───────────────────────┼───────────────────────┐
    │                       │                       │
┌───▼───┐              ┌────▼────┐             ┌────▼────┐
│ 输入层 │              │  处理层  │             │  输出层  │
├────────┤              ├─────────┤             ├─────────┤
│GET参数 │              │输入验证  │             │HTML页面 │
│POST数据│     ──►      │业务逻辑  │     ──►     │JSON响应 │
│Cookie  │              │数据库操作│             │文件下载 │
│HTTP头  │              │文件操作  │             │错误信息 │
│文件上传│              │系统调用  │             │日志记录 │
└────────┘              └─────────┘             └─────────┘
```

---

## 统计驱动的高危参数 (SQL注入)

从 27,732 个 SQL 注入案例中提取的高频危险参数名:

```python
TOP_VULNERABLE_PARAMS = {
    # 数字型ID类（最常见）
    'id': 56,           # 资源标识
    'sort_id': 37,      # 排序字段
    'stid': 32,         # 状态ID
    'fid': 8,           # 论坛/文件ID
    'hotelid': 11,      # 业务实体ID

    # 认证相关（高危）
    'username': 33,     # 用户名
    'password': 30,     # 密码
    'userpwd': 11,      # 密码变体

    # 业务逻辑参数
    'type': 18,         # 类型选择
    'action': 7,        # 操作类型
    'page': 4,          # 分页参数
    'name': 30,         # 名称搜索

    # ASP.NET特有（.NET应用重点关注）
    '__viewstate': 58,
    '__eventvalidation': 56,
    '__eventargument': 52,
    '__eventtarget': 41,
}
```

---

## 快速绕过技巧速查

### SQL注入绕过

```
空格绕过: /**/  %09  %0a  ()
关键字:   SeLeCt  sel%00ect  /*!select*/
等号:     LIKE  REGEXP  BETWEEN  IN
引号:     0x十六进制  char()  concat()
```

### XSS绕过

```
标签变形: <ScRiPt>  <script/x>  <script\n>
事件触发: onerror  onload  onmouseover  onfocus
编码绕过: HTML实体  JS Unicode  URL编码
协议利用: javascript:  data:  vbscript:
```

### 命令执行绕过

```
Linux拼接: ;  |  ||  &&  `  $()
Windows:   &  |  ||  &&
空格绕过:  ${IFS}  $IFS$9  %09  <  <>
关键字:    ca\t  ca''t  c$@at  /???/??t
```

---

## 使用指南

### 1. 代码审计增强

发现可疑代码时，查阅对应漏洞类型的 WooYun 知识:

```
发现 SQL 拼接 → 读取 sql-injection.md 获取绕过测试向量
发现文件操作 → 读取 file-traversal.md 获取路径遍历 Payload
发现认证逻辑 → 读取 logic-flaws.md 获取绕过思路
```

### 2. 渗透测试参考

黑盒测试时，使用 WooYun 的入口点识别和测试向量:

```
测试登录框 → sql-injection.md 的认证绕过章节
测试上传点 → file-upload.md 的绕过技巧章节
测试API → unauthorized-access.md 的 API 未授权章节
```

### 3. 逻辑漏洞挖掘

业务逻辑审计时，参考 logic-flaws.md 的模式库:

```
密码重置 → 4种攻击模式（回显/解绑/跳过/参数控制）
越权访问 → 水平/垂直越权测试矩阵
验证码 → 不刷新/可重用/可爆破/客户端验证
支付逻辑 → 金额篡改/数量篡改/优惠叠加
```

---

## 与 code-audit 核心模块的关系

| code-audit 模块 | WooYun 补充 |
|-----------------|-------------|
| `core/taint_analysis.md` | 提供真实案例的 Source→Sink 路径 |
| `core/bypass_strategies.md` | 提供更多绕过 Payload |
| `languages/php.md` | 提供 PHP 高危参数统计 |
| `security/business_logic.md` | 提供逻辑漏洞模式库 |

---

`★ 核心洞察: 漏洞挖掘的本质是寻找"开发者假设"与"攻击者输入"之间的偏差`
